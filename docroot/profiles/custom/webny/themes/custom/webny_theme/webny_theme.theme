<?php

/**
 * Implements hook_preprocess_html().
 */
function webny_theme_preprocess_html(&$variables) {
  // <body> classes for sidebars
  if (isset($variables['page']['sidebar_first']) && isset($variables['page']['sidebar_second'])) {
    $variables['attributes']['class'][] = 'body-sidebars-both';
  }
  elseif (isset($variables['page']['sidebar_first'])) {
    $variables['attributes']['class'][] = 'body-sidebars-first';
  }
  elseif (isset($variables['page']['sidebar_second'])) {
    $variables['attributes']['class'][] = 'body-sidebars-second';
  }
  else {
    $variables['attributes']['class'][] = 'body-sidebars-none';
  }
}

/**
 * Implements hook_preprocess_paragraph__webny_card_paragraph_type
 */
function webny_theme_preprocess_paragraph__webny_card_paragraph_type(&$variables) {
    // Load the site name out of configuration.
    $config = \Drupal::config('system.site');
    $variables['site_name'] = $config->get('name');

    // grab the host to pass to the twig template to build URLs
    $variables['host'] = \Drupal::request()->getSchemeAndHttpHost();

    // pull in paragraph object to acquire entity references
    $paragraph = $variables['paragraph'];
    $referencedEntities = $paragraph->get('field_webny_card_entity_ref');

    // loop through each referenced entity passing the url as an array to twig
    foreach($referencedEntities->referencedEntities() as $entity) {
        $variables['card_url'][] = $entity->url();
        $variables['entity_type'][] = $entity->bundle();
    }

}

/**
<<<<<<< HEAD
 * Implements hook_preprocess_node__webny_landing_page
 */
function webny_theme_preprocess_node__webny_landing_page(&$variables) {
    // Load the site name out of configuration.
    $config = \Drupal::config('system.site');
    $variables['site_name'] = $config->get('name');
}

/**
 * Implements hook_preprocess_node__webny_page__full
 */
function webny_theme_preprocess_node__webny_page__full(&$variables) {
    // Load the site name out of configuration.
    $config = \Drupal::config('system.site');
    $variables['site_name'] = $config->get('name');
}

/**
 * Implements hook_preprocess_node__webny_news
 */
function webny_theme_preprocess_node__webny_news(&$variables) {
    // Load the site name out of configuration.
    $config = \Drupal::config('system.site');
    $variables['site_name'] = $config->get('name');
}

/**
 * Implements hook_preprocess_node__webny_event
 */
function webny_theme_preprocess_node__webny_event(&$variables) {
    // Load the site name out of configuration.
    $config = \Drupal::config('system.site');
    $variables['site_name'] = $config->get('name');
}

/**
 * Implements hook_preprocess_node__webny_generic_page__full
 */
function webny_theme_preprocess_node__webny_generic_page__full(&$variables) {
    // Load the site name out of configuration.
    $config = \Drupal::config('system.site');
    $variables['site_name'] = $config->get('name');
}

/**
 * Implements hook_library_info_alter(&$libraries, $extension).
 */
function webny_theme_library_info_alter(&$libraries, $extension) {
  if ($extension !== 'webny_theme') {
    return;
  }
  if (isset($libraries['global-styling']['css']['theme'])) {
    $libraries['global-styling']['css']['theme'] = array('css/' . theme_get_setting('site_color_pallet') . '.css' => array());
  }
  $temp=0;
}

/**
 * Implements hook_theme_suggestions_field_alter().
 */
 function webny_theme_suggestions_field_alter(&$suggestions, $variables){
	 $suggestions[] = 'field__' . $variables['element']['#bundle'] . '_' . $variables['element']['#field_name'];
	 $suggestions[] = 'field__' . $variables['element']['#bundle'] . '_' . $variables['element']['#field_name'] . '__' . $variables['element']['#field_type'];
	 return $suggestions;
 }
